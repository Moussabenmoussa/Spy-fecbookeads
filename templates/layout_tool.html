<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ active.title if active else config.site_name }}</title>
    <meta name="description" content="{{ active.short_desc if active else config.site_description }}">
    
    <!-- Tailwind + Typography Plugin -->
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    
    <!-- Dynamic Head Code (Analytics/GSC) -->
    {% if config.head_code %}{{ config.head_code | safe }}{% endif %}
    <!-- AdSense Code -->
    {% if config.adsense_code %}{{ config.adsense_code | safe }}{% endif %}
</head>
<body class="bg-gray-50 text-gray-900 flex flex-col min-h-screen">

    <!-- Header -->
    <nav class="bg-white border-b sticky top-0 z-50">
        <div class="container mx-auto px-4 h-16 flex items-center justify-between">
            <a href="/" class="text-2xl font-black text-blue-700 tracking-tight">{{ config.site_name }}</a>
            <div class="text-sm font-medium text-gray-500">
                Premium Utilities
            </div>
        </div>
    </nav>

    <main class="flex-grow container mx-auto px-4 py-12">
        {% if static_content %}
            <!-- للصفحات القانونية -->
            <div class="bg-white p-10 rounded-3xl shadow-sm border border-gray-100 max-w-4xl mx-auto">
                {{ static_content | safe }}
            </div>

        {% elif not active %}
            <!-- الصفحة الرئيسية -->
            <div class="text-center mb-16 max-w-2xl mx-auto">
                <h1 class="text-4xl font-extrabold mb-4 text-gray-900">{{ config.site_name }}</h1>
                <p class="text-xl text-gray-500">{{ config.site_description }}</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto">
                {% for tool in tools %}
                <a href="/tool/{{ tool.slug }}" class="block bg-white p-8 rounded-2xl shadow-sm border border-gray-100 hover:shadow-xl hover:border-blue-200 transition-all duration-300">
                    <h2 class="text-xl font-bold mb-2 text-gray-800">{{ tool.title }}</h2>
                    <p class="text-gray-500 mb-4">{{ tool.short_desc }}</p>
                    <span class="text-blue-600 font-bold text-sm">Open Tool &rarr;</span>
                </a>
                {% endfor %}
            </div>

        {% else %}
            <!-- صفحة الأداة -->
            <div class="max-w-5xl mx-auto">
                <!-- الهيدر الخاص بالأداة -->
                <div class="text-center mb-10">
                    <h1 class="text-4xl font-black mb-4">{{ active.title }}</h1>
                    <p class="text-lg text-gray-600">{{ active.guide }}</p>
                </div>

                <!-- منطقة العمل (Application Box) -->
                <div class="bg-white p-8 md:p-12 rounded-3xl shadow-2xl border border-blue-50 mb-16 text-center">
                    {% if active.slug == 'webp-pro' %}
                        <form action="/api/webp" method="POST" enctype="multipart/form-data">
                            <input type="file" name="file" class="block w-full text-sm text-slate-500 file:mr-4 file:py-3 file:px-8 file:rounded-full file:border-0 file:text-sm file:font-bold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 mb-6 mx-auto max-w-md">
                            <button class="bg-blue-600 text-white px-8 py-4 rounded-xl font-bold shadow-lg hover:bg-blue-700 transition">Convert Image</button>
                        </form>
                    {% elif active.slug == 'qr-generator' %}
                        <form action="/api/qr" method="POST" class="max-w-md mx-auto space-y-4">
                            <input type="text" name="text" placeholder="https://..." class="w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none">
                            <button class="w-full bg-gray-900 text-white px-8 py-4 rounded-xl font-bold hover:bg-black transition">Generate QR</button>
                        </form>
                    {% endif %}
                </div>

                <!-- محتوى السيو (منسق باحترافية) -->
                <!-- استخدام فئة 'prose' من Tailwind Typography يحل مشكلة تكدس النص -->
                <article class="prose prose-lg prose-blue max-w-none bg-white p-10 md:p-16 rounded-[2rem] border border-gray-100 shadow-sm mx-auto">
                    {{ active.seo_content | safe }}
                </article>
            </div>
        {% endif %}
    </main>

    <!-- Footer -->
    <footer class="bg-gray-50 border-t py-12 mt-12">
        <div class="container mx-auto px-4 text-center">
            <div class="flex justify-center space-x-8 mb-6 font-medium text-gray-500">
                <a href="/privacy-policy" class="hover:text-blue-600">Privacy Policy</a>
                <a href="/terms" class="hover:text-blue-600">Terms of Service</a>
                <a href="/sitemap.xml" class="hover:text-blue-600">Sitemap</a>
            </div>
            <p class="text-gray-400 text-sm">&copy; 2024 {{ config.site_name }}. {{ config.footer_text }}</p>
        </div>
    </footer>

</body>
</html>
